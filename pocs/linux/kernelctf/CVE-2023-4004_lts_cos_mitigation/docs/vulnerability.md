# Vulneribility
 In function nft_pipapo_remove in file /net/netfilter/nft_set_pipapo.c, there is a line of code: 
 
 
 match_end = (const u8 *)nft_set_ext_key_end(&e->ext)->data; 
 
 
 But it is possible to insert a element without a NFT_SET_EXT_KEY_END. So it is possiable that you free the nft_pipapo_elem but you still have it in the nft_set struct.

## Requirements to trigger the vulnerability
 - Capabilities:  `CAP_NET_ADMIN` capability is required.
 - Kernel configuration: `CONFIG_NETFILTER`, `CONFIG_NF_TABLES`
 - Are user namespaces needed?: Yes
  
## Commit which introduced the vulnerability
 - [commit 3c4287f62044a90e73a561aa05fc46e62da173da](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=3c4287f62044a90e73a561aa05fc46e62da173da)

## Commit which fixed the vulnerability
- [commit 87b5a5c209405cb6b57424cdfa226a6dbd349232](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=87b5a5c209405cb6b57424cdfa226a6dbd349232)

## Affected kernel versions
- 5.6-rc1 and later

## Affected component, subsystem
- net/netfilter (nf_tables)

## Cause
- UAF

